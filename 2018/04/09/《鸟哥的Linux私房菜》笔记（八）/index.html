<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置 | 程序人生</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Kenshine,Kenshine's Blog" />
  
  <meta name="description" content="0.学习之前 包含章节《鸟哥Linux习私房菜-基础学习篇》（第三版）对应着知识点照着网上的内容整理的关于Centos7的操作（书本是Centos5.x）第14章：Linux账号管理与ACL权限设置  学习重点  账号管理 权限规划及ACL 用户身份的切换 用户之间的信息传递   注意：这章都需要root权限    1.Linux的账号与用户组1)用户标识符：UID和GID  我们登录Linux主">
<meta name="keywords" content="Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置">
<meta property="og:url" content="https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/index.html">
<meta property="og:site_name" content="程序人生">
<meta property="og:description" content="0.学习之前 包含章节《鸟哥Linux习私房菜-基础学习篇》（第三版）对应着知识点照着网上的内容整理的关于Centos7的操作（书本是Centos5.x）第14章：Linux账号管理与ACL权限设置  学习重点  账号管理 权限规划及ACL 用户身份的切换 用户之间的信息传递   注意：这章都需要root权限    1.Linux的账号与用户组1)用户标识符：UID和GID  我们登录Linux主">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-01.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-02.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-03.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-04.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-05.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-06.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-07.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-08.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-09.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-10.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-11.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-12.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-13.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-14.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-15.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-16.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-17.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-18.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-19.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-20.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-21.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-22.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-23.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-24.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-25.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-26.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-27.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-28.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-29.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-30.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-31.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-32.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-33.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-34.jpg">
<meta property="og:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-35.jpg">
<meta property="og:updated_time" content="2018-04-11T14:42:54.702Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置">
<meta name="twitter:description" content="0.学习之前 包含章节《鸟哥Linux习私房菜-基础学习篇》（第三版）对应着知识点照着网上的内容整理的关于Centos7的操作（书本是Centos5.x）第14章：Linux账号管理与ACL权限设置  学习重点  账号管理 权限规划及ACL 用户身份的切换 用户之间的信息传递   注意：这章都需要root权限    1.Linux的账号与用户组1)用户标识符：UID和GID  我们登录Linux主">
<meta name="twitter:image" content="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-01.jpg">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>

<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">Kenshine&#39;s Blog</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>首页</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>归档</span>
                    </a>
                    
                    <a target="_blank" href="/about">
                        <i class="fa fa-user"></i>
                        <span>关于</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        Kenshine&#39;s Blog
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        今天,是你余生的第一天
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="Github" target="_blank" href="//github.com/zjxkenshine">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="Weibo" target="_blank" href="//weibo.com/3807155334">
                            <i class="fa fa-weibo fa-2x"></i></a>
                    
                        <a title="Qq" target="_blank" href="/images/qq1754294529.jpg">
                            <i class="fa fa-qq fa-2x"></i></a>
                    
                        <a title="Weixin" target="_blank" href="/images/weixin-kenshine.png">
                            <i class="fa fa-weixin fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-《鸟哥的Linux私房菜》笔记（八）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/操作系统/">操作系统</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2018-04-09
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <h2 id="0-学习之前"><a href="#0-学习之前" class="headerlink" title="0.学习之前"></a>0.学习之前</h2><ol>
<li><p>包含章节<br>《鸟哥Linux习私房菜-基础学习篇》（第三版）<br>对应着知识点照着网上的内容整理的关于Centos7的操作（书本是Centos5.x）<br>第14章：Linux账号管理与ACL权限设置</p>
</li>
<li><p>学习重点</p>
<ul>
<li>账号管理</li>
<li>权限规划及ACL</li>
<li>用户身份的切换</li>
<li>用户之间的信息传递</li>
</ul>
</li>
<li><p>注意：<br>这章都需要root权限</p>
</li>
</ol>
<hr>
<h2 id="1-Linux的账号与用户组"><a href="#1-Linux的账号与用户组" class="headerlink" title="1.Linux的账号与用户组"></a>1.Linux的账号与用户组</h2><p><strong>1)用户标识符：UID和GID</strong></p>
<ol>
<li>我们登录Linux主机时，输入的是账号，但是Linux系统是通过GID(组id)和UID（用户id）来区分的。<br>每个用户登录都至少会取得这两个ID。</li>
<li>文件如何判别所有者和所在组也与GID和UID有关。</li>
<li>可以使用root账号修改/etc/passwd文件中的普通用户的ID,这时所有的和该用户ID有关的数字也跟着改变了。<br>但是不能随便更改，否则会导致很多操作无法进行。</li>
</ol>
<p><strong>2)用户账号：</strong></p>
<ol>
<li>登录时系统的处理过程：<ul>
<li>在<code>/etc/passwd</code>和<code>/etc/group</code>中比对是否有该用户的UID和GID。</li>
<li>比对<code>/etc/shadow</code>中该UID的密码</li>
<li>成功登录，进入shell管控</li>
</ul>
</li>
<li><code>/etc/passwd</code>文件结构介绍<br>cat一下发现有很多的用户，每一行代表一个，很多都是系统自带的（bin,root等），最好不要随便删除：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-01.jpg" alt=""><br>以第一行<code>root:x:0:0:root:/root:/bin/bash</code>为例，被冒号<code>:</code>分割为了7个字段：<ul>
<li>1账号名称：root,用来对应UID</li>
<li>2密码：x,因为该文件所有字段都可以读取，为了安全就放到/etc/shadow文件了</li>
<li>3UID:0</li>
<li>4GID:0,与<code>/etc/group</code>有关。</li>
<li>5用户信息说明列：root,解释账号意义</li>
<li>6主文件夹:/root</li>
<li>7获取的shell:/bin/bash</li>
</ul>
</li>
<li><code>/etc/shadow</code>文件结构介绍：<br>Linux为了保障用户信息安全，将用户密码放到<code>/etc/shadow</code>文件下并加了很多加密参数，cat一下如下图所示：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-02.jpg" alt=""><br>同样以冒号<code>:</code>作为分隔符，分为了9段，以root账号的密码字段为例：<pre><code>root:$6$WmR7M2ls44XFUhYB$Xs6Q46aC6EdOLB.a/wa2ExTCI8d5Jy1lVlkkTyI/xQ.4Jn79wNCSD8PplsBPzGWuXfhR.K4bZALAzrc2WTfrO.::0:99999:7::
</code></pre>各个子段的含义：<ul>
<li>1账号名称：root,和/etc/passwd对应</li>
<li>2密码：后面很长的一大段，经过加密的密码，在该字段前加上!或者*使密码长度增加会使密码暂时失效。</li>
<li>3最近更改日期：空，说明没修改过，一般是一个5位数的数字，代表1970年1月1日到现在的天数。</li>
<li>4密码不可变更的天数：0，表示随时可以更改。也可以设置成大一点，防止别人更改。</li>
<li>5密码必须重新更改的天数：99999，表示可以不修改，如果是20代表需要在20天之内修改，否则变为过期账号。</li>
<li>6密码过期前几天提示：7表示会在99992天是给你个警告提示你账号快过期了</li>
<li>7密码更改的宽限时间：空，表示不宽限，到那一天就过期。过期的意思就是下次登录的时候必须要设置新密码，不是失效。</li>
<li>8密码失效日期：空，表示用不失效，如果设置为一个数字，过了那个时间后，哪个账号就永久不可以用了，区别过期。</li>
<li>9保留字段：为新功能保留的。</li>
</ul>
</li>
<li>忘记密码之后的两种可行方法（3种）：<br>一般用户忘记直接找管理员解决。<br>root用户忘记：<ul>
<li>方法1：进入维护模式，单用户模式</li>
<li>方式2：以Live CD挂载后修改/etc/shadow，将密码清空，然后不用密码登录后使用passwd修改</li>
<li>方式3：重装系统</li>
</ul>
</li>
</ol>
<p><strong>3)有效用户组和初始用户组：groups,newgrp</strong></p>
<ol>
<li><code>/etc/group</code>的文件结构：<br>/etc/group就是用来记录GID和组名的对应的。<br>使用cat查看如下：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-03.jpg" alt=""><br>以第一行的<code>root:x:0:</code>为例，共有4个字段：<ul>
<li>用户组名称：root</li>
<li>用户组密码：x,记录在/etc/gshadow中</li>
<li>GID:0</li>
<li>此用户组支持的账号名称：空，如果想要将账号填入该用户组，只需要将用户名加到这里就可以了。一个用户可以添加到多个用户组。</li>
</ul>
</li>
<li>初始用户组与有效用户组：<br>用户拥有的GID在登录时都会加载，称为初始用户组。<br>在命令行使用<code># groups</code>,查看所有用户组，其中的第一个就是有效用户组：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-04.jpg" alt=""><br>执行创建等操作时以这个用户组为准。</li>
<li>切换有效用户组：<br>使用如下命令：<pre><code># newgrp 用户组名
</code></pre>所切换的用户组必须是已经在的用户组。</li>
<li><code>/etc/gshadow</code>有效用户组：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-05.jpg" alt=""><br>主要有以下四个字段，以第一为例：<ul>
<li>用户组名：root</li>
<li>密码列：空，开头为！表示无合法密码，无用户组管理员</li>
<li>用户组管理员的账号：空</li>
<li>用户组的所属账号</li>
</ul>
</li>
</ol>
<hr>
<h2 id="2-账号管理"><a href="#2-账号管理" class="headerlink" title="2.账号管理"></a>2.账号管理</h2><p><strong>1)系统管理员创建修改与删除用户</strong></p>
<ol>
<li>useradd：<br>基本语法：<pre><code># useradd [-u UID] [-g 初始用户组] [-G次要用户组] [-mM] [-c 说明栏] [-d 主文件夹绝对路径] [-s shell] 用户账号名
-u：后面接的是UID，一组数字，直接指定一个特定的UID给这个账号
-g：初始化用户组名
-G：该账号可以加入的用户组
-M：强制!不创建用户主文件夹（系统账号默认不创建）
-m：强制!创建用户主文件夹(用户账号默认创建)
-c：/etc/passwd第五列的说明内容
-d：创建某个目录成为主文件夹，使用绝对路径。
-r：创建一个系统账号，UID会有限制
-s：要使用的shell默认为/bin/shell
-e：接一个日期表示失效日期，格式为YYYY-MM-DD
-f：shadow第七个字段，是否失效，0为立即过期，-1为永远不失效
</code></pre>系统默认给我们设置了很多选项，只要简单的使用<code># useradd 用户名</code>就可以了，此时Centos会默认帮我们处理以下项目:<br>–<em>在/etc/passwd里面创建一行与用户相关的数据，包括UID,GID主文件夹等</em><br>–<em>在/etc/shadow里面填入密码，但是没有密码</em><br>–<em>在/etc/group里面加入一个和账号名称一模一样的用户组</em><br>–<em>在Home下创建一个和用户名称一样的目录作为用户主文件夹</em><br>如果指定用户组创建，且用户组已存在则不会创建和用户组同名的用户组。<br>用户主文件夹目录：/home/账号名称</li>
<li><p>useradd参考文件：<br>使用<code>useradd -D</code>即可查看默认的配置：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-06.jpg" alt=""><br>该数据是由<code>/etc/default/useradd</code>调出来的。<br>简单介绍每行的意思：</p>
<pre><code>GROUP=100        --默认用户组为100
HOME=/home        --默认用户主文件夹所在位置
INACTIVE=-1        --密码失效日（过期日）shadow中的第七列
EXPIRE=            --账号失效日，不可使用，shadow中的第八列
SHELL=/bin/bash        --默认的shell
SKEL=/etc/skel        --用户主文件夹的内容数据参考目录
CREATE_MAIL_SPOOL=yes    --帮用户创建邮件信箱
</code></pre><p>UID/GID/密码参数的默认参考地址：/etc/login.def<br>cat一下有很多的注释，去掉注释大概是这样的：</p>
<pre><code>[root@localhost ~]# cat /etc/login.defs
MAIL_DIR    /var/spool/mail    --默认的邮件信箱放置位置

PASS_MAX_DAYS    99999   --多久修改密码天数
PASS_MIN_DAYS    0        --多久不可修改密码天数
PASS_MIN_LEN    5        --密码最短长度，已被pam模块代替，无效
PASS_WARN_AGE    7        --过期前几天警告
//用户及用户组ID的规定
UID_MIN     1000
UID_MAX     60000
SYS_UID_MIN    201
SYS_UID_MAX   999
GID_MIN        1000
GID_MAX        60000
SYS_GID_MIN    201
SYS_GID_MAX    999

CREATE_HOME    yes     --是否主动创建
UMASK  077            --用户主文件夹创建的umask，表示是700
USERGROUPS_ENAB yes        --删除用户时是否连带删除用户组
ENCRYPT_METHOD SHA512     --密码是否经过加密处理
</code></pre></li>
<li>passwd修改密码:<br>useradd创建的用户账号默认是冻结的，无法登陆因为没有设置密码，需要使用passwd来设置密码：<pre><code># passwd [--stdin]  &lt;--所有人都可以用来修改自己的密码
# passwd [-l] [-u] [--stdin] [-S] [-n 天数] [-x 天数] [-w 天数] [-i 日期] 账号
--stdin：将前一个管道的数据作为密码输入
-l：lock,会在/etc/shadow第二列最前面加上!是使密码失效
-u：与-l相对，unlock,解除账号锁定
-S：列出密码相关参数，即shadow文件内的大部分信息
-n：多久不可修改密码的天数
-x：多久内必须要改动密码
-w：提示天数
-x：shadow第7个字段，密码失效的日期
</code></pre>可以直接使用<code>$ passwd</code>来按提示一步步修改自己的密码。<br>root用户可以使用<code># passwd 账号</code>逐步修改该用户账号的密码。<br>还有<code>--stdin</code>参数，修改账号密码只需要如下方式：<pre><code># echo &quot;密码&quot; | passwd --stdin 账号
</code></pre>但是可以在history中找到你的密码，所以要慎用，只在shell script需要创建很多账号时使用。<br>禁用与解封：<code># passwd -l/-u 账号</code><br>简单测试：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-07.jpg" alt=""></li>
<li>chage查看更详细的密码参数：<br>和passwd -S类似但是更加详细。语法如下：<pre><code># chage [-ldEImMW] 账号名
-l：列出该账号详细的密码参数
-d：接日期，修改shadow的第3个字段（最近修改密码的时间），格式为YYYY-MM-DD
-E：接日期，修改。。。的第8个字段(账号失效日)，格式为YYYY-MM-DD
-I：接天数，对应第7个字段，密码失效日期
-m：接天数，对应第4个字段，保留日期
-M：接天数，对应第5个字段，需要多久进行修改
-W：接天数，对应第6个字段，失效前警告日期
</code></pre>如列出kenshine用户的密码参数：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-08.jpg" alt=""></li>
<li>usermod修改账号数据<br>对账号的相关数据进行微调可以直接到/etc/passwd和/etc/shadow进行微调也可以使用usermod命令，参数如下：<pre><code># usermod [-cdegGlsuLU] username
参数
-c：接账号说明，/etc/passwd第5列的说明
-d：接账号的主文件夹，..第6列
-e：接日期，YYYY-MM-DD,shadow第八列,失效时间
-f：后面接天数，shadow第七列
-g：接初始用户组，passwd第4个字段
-G：接次要用户组，修改的是group文件的数据
-a：与-G和用可以增加次要用户组
-l：接账号名称，修改账号名
-s：接shell实际文件表示使用的shell
-u：接UID，最好不要随便修改    
-L：冻结账户的密码
-U：解冻密码
</code></pre>书上的例子：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-09.jpg" alt=""></li>
<li>userdel<br>删除用户的相关数据，包括：<br>用户账号密码参数，用户组相关参数，用户个人文件夹<br>语法:<pre><code># userdel [-r] 用户名
-r：连同用户主文件夹一起删除
</code></pre>测试：创建一个新用户然后删除<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-10.jpg" alt=""></li>
</ol>
<p><strong>2)用户功能:finger,chfn,id的使用</strong><br>上面的命令都是系统管理员才能使用的命令，一般用户也可以修改账号数据以及查询等。</p>
<ol>
<li>finger查阅用户相关的信息<br>大部分都是/etc/passwd文件里的。基本用法：<pre><code># finger [-s] username
-s：仅列出用户的账号，全名，终端机代号与登录时间等
-m：列出与后面接的账号相同者。
</code></pre>如果没有finger命令可以使用下面的命令自己安装(需要联网)：<pre><code># yum -y install finger
</code></pre>一般用户使用<code>$ finger</code>来查看当前账号的信息。<br>具体的信息一般都看的懂，就不多写了。</li>
<li>chfn个人属性修改<br>一般用不到，简单的参数介绍：<pre><code># chfn [-foph] [账号名]
-f：你的全名
-o：办公室号码
-p：办公室电话
-h：家里的电话
</code></pre>也可以直接使用<code>$ chfn</code>来修改自己的相关信息，一开始会让你输入密码确认，然后就可以修改了。</li>
<li>chsh修改自己使用的shell<br>使用方法：<pre><code>$ chsh [-ls]
-l：列出目前系统上可用的shell
-s：设置修改自己的shell
</code></pre>无论是chfn和chsh都有修改/etc/passwd的权限，所以该文件的权限为SUID。</li>
<li>id查看自己或者某人相关的UID/GID<br>有很多参数不过都不要记只要用id就可以全部列出：<pre><code># id [username]
</code></pre><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-11.jpg" alt=""></li>
</ol>
<p><strong>3)用户组的新增与删除：</strong></p>
<ol>
<li>groupadd新增用户组<br>语法：<pre><code># groupadd [-g gid] [-r] 用户组名
-g：后面跟GID来直接给予GID
-r：新建系统用户组，与/etc/login.defs中的GID_MIN有关。
</code></pre>最好使用<code>group =r 组名</code>的方式创建。</li>
<li>groupmod修改组参数<br>与usermod类似，基本语法：<pre><code># groupmod [-g gid] [-n group_name] 用户组名
-g：修改GID
-n：修改组名
</code></pre>但是最好不要随意改动，避免出错。</li>
<li>groupdel删除用户组<pre><code># groupdel 用户组名
</code></pre>如果有账号以该用户组为初始用户组则不能删除，所以删除之前得先确认。<br>可以删除该用户或者修改用户的GID，然后再进行删除。</li>
<li>gpasswd:用户组管理员功能<br>系统管理员太过繁忙，可以设置用户组管理员来协助管理该用户组。<br>用户组管理员可以管理那些账号可以加入或者移除该用户组。<br>系统管理员使用gpasswd创建用户组管理员：<pre><code># gpasswd groupname
# gpasswd [-A user1,user2...] [-M user3,user4...] 组名
# gpasswd [-rR] groupname
参数：
没有任何参数表示给用户组设置一个密码
-A：将该组的主控权交给后面的user
-M：将这些用户加入该组
-r：删除这个组的密码
-R：使这个组的密码失效
</code></pre>用户组管理员的功能（系统管理员也能使用）：<pre><code># gpasswd [-ad] user 组名
-a：添加user到这个组
-d：将user从这个组删除
</code></pre></li>
</ol>
<hr>
<h2 id="3-主机的具体权限规划：ACL的使用"><a href="#3-主机的具体权限规划：ACL的使用" class="headerlink" title="3. 主机的具体权限规划：ACL的使用"></a>3. 主机的具体权限规划：ACL的使用</h2><p><strong>1)ACL的简介与启动</strong></p>
<ol>
<li>ACL简介：<br>ACL全称Access Control List，提供了传统的owner,group,others的rwx权限之外的具体权限设置。<br>可以针对单一用户，单一文件或者目录进行rwx权限的设置。</li>
<li>ACL的启动：<br>ACL是传统的UnixLike支持的系统的额外支持项目，所有要使用ACL必须要文件系统的支持。可以使用mount查看，查看方法如下：<pre><code># dumpe2fs -h 文件系统目录 |grep acl
</code></pre>文件系统目录可以使用<code># mount</code>或<code># fdisk -l</code>查看。<br>如果没有安装则需要重新挂载：<pre><code># mount-o remount,acl /
</code></pre>这样就可以了。<br>基本现在的Linux都是支持的了。</li>
</ol>
<p><strong>2)ACL的设置：getfacl,setfacl</strong><br>获取ACL支持后就可以设置和查看ACL了。</p>
<ol>
<li>setfacl：设置acl<pre><code># setfacl [-bkRd] [{m|x} acl参数] 目标文件|目录
-m：设置后续的acl参数给文件使用，不能和-x合用
-x：删除后续的acl参数，不能和-m合用
-b：删除所有的ACL设置参数
-k：删除ACL默认参数
-R：递归设置ACL，子目录也会被设置
-d：设置默认的acl参数，只对目录有效
</code></pre></li>
<li>getcal：查看acl<br>参数和setfacl相同，简要用法就是：<pre><code># getcal 一堆参数 目标文件|目录
</code></pre></li>
<li>acl参数不同的情况设置方式：<ul>
<li>针对特定用户的参数：<code>u:[用户列表]:[rwx]</code><br>如：<code># setfacl -m u:[kenshine]:[rwx] aaa</code><br>表示设置kenshine用户对aaa文件有rwx权限</li>
<li>针对用户组的设置参数：<code>g:[用户组列表]:[rwx]</code><br>如：<code># setfacl -m g:[kenshine]:[rwx] aaa</code></li>
<li>针对有效权限mask的设置方式：<code>m:[rwx]</code><br>用户或组所设置权限必须要小于mask的设置。mask在使用getcal查看用户组的acl设置时可以看到。<br>如mask为r-x则设置为rwx会出错。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="4-用户身份的切换"><a href="#4-用户身份的切换" class="headerlink" title="4.用户身份的切换"></a>4.用户身份的切换</h2><p><strong>1)为什么要切换用户身份：</strong></p>
<ol>
<li>平时操作系统应该使用一般账号，比较安全</li>
<li>用较低的权限启动系统服务，<br>有时候需要以某些系统账号来进行程序的执行，如创建Redis用户来启动redis软件等。</li>
<li>有些软件不能以root账号登录。</li>
</ol>
<p><strong>2)su：最简单的切换命令</strong></p>
<ol>
<li>可以进行任何形式的身份切换。基本语法如下：<pre><code># su [-lm] [-c 命令] [username]
-：单纯使用减号，代表使用login-shell的变量读取方式来登录系统
-l：与-类似，后面加要切换的用户名字，也是loginshell方式，需要登录
-m：和-p一样的，使用目前环境的设置，而不读取新用户的配置文件
-c：仅进行一次的命令，-c后面可以加上命令
</code></pre></li>
<li>切换到root目录：<code>$ su</code>或者<code>$ su -</code>，这是临时切换用户。<br>但是以前一中方式未加-号，则是相当于一种环境，只是该UID有了root权限一样。读取的方式为non-login shell的方式,这种方式有很多原本的变量不会改变。<br>而后一种情况则是会将用户信息也一起改变，所以推荐使用-号。<br>不管是哪种情况，只要使用exit都可以退出su的环境。</li>
<li>完整切换用户root：<code>$ su - root</code>或者<code>$ su -l root</code>，会将用户的USER/PATH/MAIL等一并切换过去。</li>
<li>测试：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-12.jpg" alt=""></li>
<li>如果只有一个要在另一个用户执行的命令时，可以使用-C参数，如：<pre><code>$ su - -C&apos;执行的命令&apos;
</code></pre></li>
<li>su的缺点：<br>root切换到其他用户不需要密码，但是其他用户之间的切换需要那个用户的密码，所以很麻烦，而且root密码会泄露。这时就需要sudo了，它只需要输入用户自身的密码，甚至可以不用密码。</li>
</ol>
<p><strong>3)sudo：</strong></p>
<ol>
<li>并非所有人都能够执行sudo这个命令，只有/etc/sudoers内的用户才能够执行sudo这个命令。</li>
<li>sudo命令的用法：<pre><code>sudo [-b] [-u 新用户账号] [命令]
-b：将后续的命令让系统自动执行，并不与目前的shell产生影响。
-u：后面接要切换的用户，不加则默认为root
-i：改变用户对命令使用权限的命令
</code></pre>还有很多的参数，详情可以man sudo。<br>这是目前版本的使用方法：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-13.jpg" alt=""><br>一般使用<code># sudo -i -u 用户名</code>来强制切换。</li>
<li>sudo默认只有root能够使用，但是root使用sudo不需要密码。</li>
<li>其他用户要想使用sudo命令必须要使用root权限使用visudo来设置用户。<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-14.jpg" alt=""><br>需要在root下加上用户名。<br>或者在%wheel改为用户所在的用户组。<br>visudo只是使用vi将sudors文件调出来而已。</li>
<li><code>root ALL=(ALL) ALL</code>的含义<br>root：用户账号<br>ALL：登录者的来源主机名，第二个字段。<br>(ALL)：可切换的身份<br>ALL：可执行的命令，<strong>必须是使用绝对路径编写的</strong></li>
<li>通过别名设置visudo<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-15.jpg" alt=""><br>!表示失效，在修改时会比较方便。</li>
<li>sudo的时间间隔问题：<br>使用一次sudo输入密码之后，后面短时间内再次使用sudo不会再让你输入密码。<br>一般是5分钟之内。</li>
<li><code>sudo</code>搭配<code>su</code>使用：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-16.jpg" alt=""><br>这样这几个用户就可以直接使用<code>$ sudo su-</code>来切换到root用户，而且只需要输入自己的密码就可以了。</li>
</ol>
<hr>
<h2 id="5-用户特殊shell和PAM模块"><a href="#5-用户特殊shell和PAM模块" class="headerlink" title="5.用户特殊shell和PAM模块"></a>5.用户特殊shell和PAM模块</h2><p><strong>1)使用者的特殊shell,/sbin/nologin</strong></p>
<ol>
<li>系统账号的shell就是使用的/sbin/nologin。系统账号是不需要登录的所以给它这个不要登录的合法shell，而且这个shell也不能够登录。<br>如果使用su等方式切换到这个系统账号则会报错(如mail)<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-17.jpg" alt=""></li>
<li>这个报错信息时可以设置的，使用vi编辑/etc/nologin.txt文件即可。<pre><code># vi /etc/nologin.txt
</code></pre>这样下一次用户想要登录该系统账号时就会显示这里面编辑的信息。</li>
</ol>
<p><strong>2)PAM模块简介</strong></p>
<ol>
<li>过去的Linux想要对一个用户进行认证需要输入账号密码，然后自行编写程序来判断密码是否正确，会导致一台Linux主机上有多个认证程序。PAM模块就是为了解决这个问题的。</li>
<li>PAM模块可以说是一套应用程序接口，它提供了一连串的验证机制，只要用户将验证阶段的需求告知PAM后，PAM就能够回报用户验证结果（成功或者失败）</li>
<li>PAM用来验证的数据称为模块，有很多个模块，每个模块的作用都不相同。<br>模块可以自己设置。</li>
</ol>
<p><strong>3)PAM模块的设置</strong></p>
<ol>
<li>调用passwd命令后PAM的执行流程：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-18.jpg" alt=""><br>重点就是那个/etc/pam.d内的配置文件</li>
<li>使用cat查看/etc/pam.d/passwd文件的内容：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-19.jpg" alt=""><br>可以看到分为了三个字段：<strong>验证类型，控制标准以及PAM模块-参数</strong>。</li>
<li>第一个字段，验证类别，主要分为四种：<br><code>auth</code>：使用密码验证用户身份<br><code>account</code>：验证是否有用户的使用权限<br><code>session</code>：用于记录用户登录与注销时的信息<br><code>passwd</code>：密码的意思，提供验证的修订工作<br>这4个通常是有顺序的，但也有例外</li>
<li>第二个字段，验证的控制标志：<br>主要也分为四种：<br><code>required</code>：成功则带有success标志，失败则带有fail标志，但是成功或者失败都会继续后面的验证流程。有利于登录日志，最常用。<br><code>requisite</code>：失败则回报原程序failure标志并且终止后面的程序继续执行，成功则带有success标志继续执行。<br><code>sufficient</code>：成功则回报success终止执行，失败则带failure标志继续执行，和requisite相反。<br><code>optional</code>：大多用在显示信息，非验证。<br>要注意的是上图的include:<br>调用后面的文件（/etc/pam.d/system-auth）来进行类别的验证。</li>
<li>pam的验证流程如下：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-20.jpg" alt=""></li>
</ol>
<p><strong>4)常用的模块：</strong></p>
<ol>
<li>使用cat查看/ect/pam.d/login以及/ect/pam.d/system-auth<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-21.jpg" alt=""><br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-22.jpg" alt=""></li>
<li>可以看到使用了很多的pam模块，详细的情报可以在以下文件获得：<br>/ect/pam.d/*：每个文件的各别pam的配置文件<br>/lib/security/*：pam文件的实际放置目录。<br>/ect/security/*：其他pam的配置目录<br>/usr/share/doc/pam-*：详细的pam说明文档</li>
<li>常见的几个模块：<br><code>pam_securrtty.so</code>：限制系统管理员只能从安全的终端机登录<br><code>pam_nologin.so</code>：限制一般用户是否能够登录主机，如果存储在该文件则不能登录<br><code>pam_selinux.so</code>：先将SELinux关闭，等到验证通过后再开启<br><code>pam_console.so</code>：当系统出现问题时使用该模块处理一些权限问题，使用户能通过特殊的终端接口顺利登录系统。<br><code>pam_loginuid.so</code>：验证uid<br><code>pam_env.so</code>：设置环境变量<br><code>pam_UNIC.so</code>：功能非常多，可用于验证阶段的认证，可用于账号许可证管理，可以管理日志等等<br><code>pam_cracklib.so</code>：验证密码强度。</li>
<li>login的pam处理流程：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-23.jpg" alt=""></li>
</ol>
<hr>
<h2 id="6-Linux主机上用户信息的传递"><a href="#6-Linux主机上用户信息的传递" class="headerlink" title="6.Linux主机上用户信息的传递"></a>6.Linux主机上用户信息的传递</h2><p><strong>1)查询用户：w,who,last,lastlog</strong></p>
<ol>
<li>查询目前已经登录在系统的用户，通过w,who来操作。<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-24.jpg" alt=""></li>
<li>查询最近登录的用户：last,lastlog<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-25.jpg" alt=""><br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-26.jpg" alt=""></li>
<li>上面所显示的pts/0等指的是终端接口。</li>
</ol>
<p><strong>2)用户对谈：write,mesg,wall</strong></p>
<ol>
<li>write：直接传递信息<pre><code># write 用户账号 [用户所在端口]
</code></pre>以Ctrl+D来结束输入。<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-27.jpg" alt=""><br>此时的接收账号的显示：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-28.jpg" alt=""><br>不管该用户在干什么都会接受到这个消息。<br>直接按回车就可以退出消息接收。</li>
<li>可以选择拒接一般用户的消息：<pre><code>$ mesg n
</code></pre>会提示无法发送消息。<br>开启接收一般用户的消息：<pre><code>$ mesg y
</code></pre><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-29.jpg" alt=""><br>但是来自root的消息仍然会接收到。</li>
<li>root用户群发消息，对所有用户广播：<pre><code># wall &quot;message&quot;
</code></pre>如：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-30.jpg" alt=""></li>
</ol>
<p><strong>3)用户邮箱信件：mail</strong></p>
<ol>
<li>write,wall需要用户在线才能接收到，而使用邮箱mailbox则能在用户不在线时发送邮件。mailbox一般放在/var/spool/mail里面，一个账号有一个mailbox文件。<br>这里存放的都是未读的邮件。</li>
<li>发送邮件：<pre><code># mail 用户名 -s &quot;邮件标题&quot; 
//写文件内容
.    -- 以小数点结束
Cc：写副本，寄给别人，Enter结束
</code></pre>可以使用数据流重定向来代替键盘的输入：<pre><code># mail 用户名 -s &quot;邮件标题&quot; &lt; 文件名
</code></pre></li>
<li>而接收用户可以直接使用mail进入邮箱环境进行各种操作：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-31.jpg" alt=""></li>
<li>mail环境的各种操作：使用?就可以看到<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-32.jpg" alt=""><br>可以使用首字母来操作。</li>
<li>常用的mail操作：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-33.jpg" alt=""></li>
</ol>
<hr>
<h2 id="7-批量创建账号"><a href="#7-批量创建账号" class="headerlink" title="7.批量创建账号"></a>7.批量创建账号</h2><p>一般不推荐手动批量新建账号。<br><strong>1)账号检查工具：</strong></p>
<ol>
<li>pwdck,grpck<br><code># pwdck</code>：所有用户的检查，检查/etc/passwd站好配置文件内的信息与实际主文件是否相等，passwd文件和shadow文件是否匹配等。<br><code># grpck</code>：所有用户组的检查。<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-34.jpg" alt=""></li>
<li>pwconv<br>只是将passwd文件第二列的密码移动到shadow上而已，如果是正常使用useradd添加的用户则使用该命令<code># pwconv</code>时不会进行任何操作。</li>
<li>pwunconv<br>与上述相反切会将shadow文件删除，没有备份的时候使用后果非常严重，慎用。</li>
<li>chapsswd<br>经常使用在批量创建账号的时候，会将未加密的密码读入，使用SHA512加密后写到shadow文件中。</li>
</ol>
<p><strong>2)书上的创建范例：</strong><br>因为不太重要且比较麻烦我就不测试了，书上的例子：<br><img src="http://p5ki4lhmo.bkt.clouddn.com/00033%E9%B8%9F%E5%93%A5Linux%E5%AD%A6%E4%B9%A08-35.jpg" alt=""></p>
<hr>
<h2 id="8-重要命令总结"><a href="#8-重要命令总结" class="headerlink" title="8.重要命令总结"></a>8.重要命令总结</h2><p><code># newgrp 用户组名</code>： 切换有效用户组</p>
<p><code># useradd [-u UID] [-g 初始用户组] [-G次要用户组] [-mM] [-c 说明栏] [-d 主文件夹绝对路径] [-s shell] 用户账号名</code><br><code># useradd 用户名</code>： 添加新用户<br><code># useradd -D</code>： 查看默认新建用户的配置<br><code># passwd [--stdin]</code>： 所有人都可以用来修改自己的密码<br><code># passwd [-l] [-u] [--stdin] [-S] [-n 天数] [-x 天数] [-w 天数] [-i 日期] 账号</code><br>–&gt;root用户用来给一般用户改密码，设置密码<br><code># echo &quot;密码&quot; | passwd --stdin 账号</code>： 管道方式<br><code># passwd -l/-u 账号</code>： 禁用与解封账号<br><code># chage [-ldEImMW] 账号名</code>： 查看账号的详细信息<br><code># usermod [-cdegGlsuLU] username</code>： 修改账号的信息<br><code># userdel [-r] 用户名</code>： 删除用户(-r：连同用户主文件夹一起删除)</p>
<p><code># finger [-s] username</code>： 查阅用户的相关信息<br><code># yum -y install finger</code>： 安装finger工具<br><code># chfn [-foph] [账号名]</code>： 个人信息的设置（办公室电话等）<br><code>$ chsh [-ls]</code>： 修改自己的shell<br><code># id [username]</code>： 列出自己或与username相关的UID和GID</p>
<p><code># groupadd [-g gid] [-r] 用户组名</code>： 新增用户组<br><code># groupmod [-g gid] [-n group_name] 用户组名</code>： 修改用户组参数<br><code># groupdel 用户组名</code>： 删除用户组</p>
<pre><code>//root用户设置用户组管理员
# gpasswd groupname
# gpasswd [-A user1,user2...] [-M user3,user4...] 组名
# gpasswd [-rR] groupname
</code></pre><p><code># gpasswd [-ad] user 组名</code>： 用户组管理员的功能</p>
<pre><code>//设置acl
# setfacl [-bkRd] [{m|x} acl参数] 目标文件|目录
-m：设置后续的acl参数给文件使用，不能和-x合用
-x：删除后续的acl参数，不能和-m合用
-b：删除所有的ACL设置参数
-k：删除ACL默认参数
-R：递归设置ACL，子目录也会被设置
-d：设置默认的acl参数，只对目录有效
</code></pre><p><code># getfacl [-bkRd] [{m|x} acl参数] 目标文件|目录</code>： 查看acl</p>
<p><code># su [-lm] [-c 命令] [username]</code>： 用户身份切换，使用对方密码<br><code>$ su - -C&#39;执行的命令&#39;</code>： 切换到root用户且只执行一次命令<br><code>sudo [-b] [-u 新用户账号] [命令]</code>： 用户身份切换，使用自己的密码</p>
<p><code># w</code>,<code># who</code>： 查看哪些用户在线<br><code># last</code>,<code># lastlog</code>： 查看用户的上次登录时间</p>
<p><code># write 用户账号 [用户所在端口]</code>： 发送交流信息<br><code>$ mesg y/n</code>： 开启，拒接消息<br><code># wall &quot;message&quot;</code>： 全体发送广播<br><code># mail 用户名 -s &quot;邮件标题&quot;</code>： 发送邮件<br><code># mail 用户名 -s &quot;邮件标题&quot; &lt; filename</code>： 数据流重定向发送邮件</p>
<p><code># pwdck</code>：所有用户的检查，检查/etc/passwd站好配置文件内的信息与实际主文件是否相等，passwd文件和shadow文件是否匹配等。<br><code># grpck</code>：所有用户组的检查。</p>
<hr>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2018年04月11日 22:42</p>
        <p>原始链接： <a class="post-url" href="/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/" title="《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置">https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/</a></p>
        <footer>
            <a href="https://zjxkenshine.github.io">
                <img src="/images/logo.png" alt="周建新">
                周建新
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        请我吃糖~
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/&title=《《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置》 — 程序人生&pic=https://zjxkenshine.github.ioimages/logo.png" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/&title=《《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置》 — 程序人生&source=程序人生" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《《鸟哥的Linux私房菜》笔记（八）：Linux账号管理与ACL权限设置》 — 程序人生&url=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/&via=https://zjxkenshine.github.io" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://zjxkenshine.github.io/2018/04/09/《鸟哥的Linux私房菜》笔记（八）/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Linux/" class="color1">Linux</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0-学习之前"><span class="post-toc-text">0.学习之前</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-Linux的账号与用户组"><span class="post-toc-text">1.Linux的账号与用户组</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-账号管理"><span class="post-toc-text">2.账号管理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-主机的具体权限规划：ACL的使用"><span class="post-toc-text">3. 主机的具体权限规划：ACL的使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-用户身份的切换"><span class="post-toc-text">4.用户身份的切换</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-用户特殊shell和PAM模块"><span class="post-toc-text">5.用户特殊shell和PAM模块</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#6-Linux主机上用户信息的传递"><span class="post-toc-text">6.Linux主机上用户信息的传递</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#7-批量创建账号"><span class="post-toc-text">7.批量创建账号</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8-重要命令总结"><span class="post-toc-text">8.重要命令总结</span></a></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2018/04/10/Redis学习笔记（二）：常用命令及Jedis使用/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          Redis学习笔记（二）：key命令，Jedis使用以及String字符串类型操作
        
      </span>
    </a>
  
  
    <a href="/2018/04/08/Windows命令行cmd中遇到的问题/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">Windows命令行cmd中遇到的问题及解决</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
          <div id="uyan_frame"></div>
  <script src="http://v2.uyan.cc/code/uyan.js?uid=2158265"></script>

    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2018 周建新<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "https://zjxkenshine.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Java基础/">Java基础</a><a class="category-link" href="/categories/Java框架/">Java框架</a><a class="category-link" href="/categories/NoSQL/">NoSQL</a><a class="category-link" href="/categories/学习笔记/">学习笔记</a><a class="category-link" href="/categories/开发工具/">开发工具</a><a class="category-link" href="/categories/操作系统/">操作系统</a><a class="category-link" href="/categories/数据库/">数据库</a><a class="category-link" href="/categories/杂记/">杂记</a><a class="category-link" href="/categories/版本控制工具/">版本控制工具</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/Commons/" style="font-size: 10px;">Commons</a> <a href="/tags/Git/" style="font-size: 14.29px;">Git</a> <a href="/tags/JNDI/" style="font-size: 10px;">JNDI</a> <a href="/tags/JVM/" style="font-size: 15.71px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Maven/" style="font-size: 12.86px;">Maven</a> <a href="/tags/MyBatis/" style="font-size: 17.14px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 18.57px;">MySQL</a> <a href="/tags/Redis/" style="font-size: 18.57px;">Redis</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/SpEL/" style="font-size: 10px;">SpEL</a> <a href="/tags/Spring/" style="font-size: 17.14px;">Spring</a> <a href="/tags/Spring-AOP/" style="font-size: 10px;">Spring AOP</a> <a href="/tags/Spring-MVC/" style="font-size: 11.43px;">Spring MVC</a> <a href="/tags/Spring核心框架/" style="font-size: 14.29px;">Spring核心框架</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/多线程/" style="font-size: 15.71px;">多线程</a> <a href="/tags/学习路线/" style="font-size: 10px;">学习路线</a> <a href="/tags/并发/" style="font-size: 17.14px;">并发</a> <a href="/tags/正则表达式/" style="font-size: 11.43px;">正则表达式</a> <a href="/tags/类/" style="font-size: 12.86px;">类</a> <a href="/tags/连接池/" style="font-size: 10px;">连接池</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>首页</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>归档</span>
                </a>
            </li>
            
            <li>
                <a target="_blank" href="/about">
                    <i class="fa fa-user"></i><span>关于</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/Commons/" style="font-size: 10px;">Commons</a> <a href="/tags/Git/" style="font-size: 14.29px;">Git</a> <a href="/tags/JNDI/" style="font-size: 10px;">JNDI</a> <a href="/tags/JVM/" style="font-size: 15.71px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Maven/" style="font-size: 12.86px;">Maven</a> <a href="/tags/MyBatis/" style="font-size: 17.14px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 18.57px;">MySQL</a> <a href="/tags/Redis/" style="font-size: 18.57px;">Redis</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/SpEL/" style="font-size: 10px;">SpEL</a> <a href="/tags/Spring/" style="font-size: 17.14px;">Spring</a> <a href="/tags/Spring-AOP/" style="font-size: 10px;">Spring AOP</a> <a href="/tags/Spring-MVC/" style="font-size: 11.43px;">Spring MVC</a> <a href="/tags/Spring核心框架/" style="font-size: 14.29px;">Spring核心框架</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/多线程/" style="font-size: 15.71px;">多线程</a> <a href="/tags/学习路线/" style="font-size: 10px;">学习路线</a> <a href="/tags/并发/" style="font-size: 17.14px;">并发</a> <a href="/tags/正则表达式/" style="font-size: 11.43px;">正则表达式</a> <a href="/tags/类/" style="font-size: 12.86px;">类</a> <a href="/tags/连接池/" style="font-size: 10px;">连接池</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
</body>
</html>